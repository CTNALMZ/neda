<Project Sdk="Microsoft.NET.Sdk">
  <!-- ================= TEMEL ================= -->
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <OutputType>Library</OutputType>
    <AssemblyName>NEDA.AI</AssemblyName>
    <RootNamespace>NEDA.AI</RootNamespace>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <LangVersion>latest</LangVersion>
    <!-- Native + ML uyumluluÃ„Å¸u -->
    <PlatformTarget>x64</PlatformTarget>
    <!-- Unsafe code iÃƒÂ§in gerekli -->
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <!-- YÃƒÂ¼ksek performans iÃƒÂ§in -->
    <EnablePreviewFeatures>true</EnablePreviewFeatures>
  </PropertyGroup>
  <!-- ================= CORE BAÃ„ÂLANTISI ================= -->
  <ItemGroup>
    <ProjectReference Include="..\NEDA.Core\NEDA.Core.csproj" />
  </ItemGroup>
  <!-- ================= SYSTEM GÃƒâ€“RÃƒÅ“NTÃƒÅ“LEME VE Ã„Â°Ã…ÂLEME ================= -->
  <ItemGroup>
    <!-- GÃƒÂ¶rÃƒÂ¼ntÃƒÂ¼ iÃ…Å¸leme iÃƒÂ§in (Bitmap, Image, Graphics) -->
    <PackageReference Include="System.Drawing.Common" Version="8.0.0" />
    <!-- ValueTask ve IAsyncEnumerable iÃƒÂ§in -->
    <PackageReference Include="System.Threading.Tasks.Extensions" Version="4.5.4" />
    <!-- Paralel iÃ…Å¸lemler ve koleksiyonlar -->
    <!-- JSON iÃ…Å¸lemleri (configuration iÃƒÂ§in) -->
    <PackageReference Include="System.Text.Json" Version="8.0.0" />
    <PackageReference Include="BCrypt.Net-Next" Version="4.0.3" />
    <PackageReference Include="FluentValidation" Version="11.9.2" />
    <PackageReference Include="Humanizer.Core" Version="2.14.1" />
    <PackageReference Include="MediatR" Version="12.2.0" />
    <PackageReference Include="Microsoft.Extensions.Configuration.Abstractions" Version="8.0.0" />
    <PackageReference Include="Microsoft.Extensions.DependencyInjection.Abstractions" Version="10.0.1" />
    <PackageReference Include="Microsoft.Extensions.Logging.Abstractions" Version="8.0.0" />
    <PackageReference Include="Microsoft.Extensions.Options" Version="10.0.1" />
    <PackageReference Include="Newtonsoft.Json" Version="13.0.3" />
    <PackageReference Include="NodaTime" Version="3.1.9" />
    <PackageReference Include="System.IdentityModel.Tokens.Jwt" Version="7.0.3" />
  </ItemGroup>
  <!-- ================= DEPENDENCY INJECTION ================= -->
  <ItemGroup>
    <PackageReference Include="Microsoft.Extensions.Configuration" Version="8.0.0" />
    <PackageReference Include="Microsoft.Extensions.Configuration.Json" Version="8.0.0" />
  </ItemGroup>
  <!-- ================= LLM / AI ================= -->
  <ItemGroup>
    <PackageReference Include="LLamaSharp" Version="0.10.0" />
    <PackageReference Include="LLamaSharp.Backend.Cpu" Version="0.10.0" />
  </ItemGroup>
  <!-- ================= GPU (OPSÃ„Â°YONEL) ================= -->
  <!-- CUDA yalnÃ„Â±zca GPU olan makinelerde aktif edilmeli -->
  <PropertyGroup>
    <!-- Build ayarlarÃ„Â±nda EnableCuda'yÃ„Â± true yaparak aktif edin -->
    <EnableCuda>false</EnableCuda>
  </PropertyGroup>
  <ItemGroup Condition="'$(EnableCuda)'=='true'">
    <PackageReference Include="LLamaSharp.Backend.Cuda12" Version="0.10.0" />
    <PackageReference Include="Microsoft.ML.OnnxRuntime.Gpu" Version="1.16.3" />
    <PackageReference Include="SciSharp.TensorFlow.Redist-Windows-GPU" Version="2.10.0" />
  </ItemGroup>
  <!-- ================= ML / VISION ================= -->
  <ItemGroup>
    <!-- Microsoft ML Stack -->
    <PackageReference Include="Microsoft.ML" Version="3.0.1" />
    <PackageReference Include="Microsoft.ML.OnnxRuntime" Version="1.16.3" />
    <PackageReference Include="Microsoft.ML.Vision" Version="3.0.1" />
    <!-- OpenCV iÃƒÂ§in -->
    <PackageReference Include="OpenCvSharp4" Version="4.8.0.20230708" />
    <PackageReference Include="OpenCvSharp4.runtime.win" Version="4.8.0.20230708" Condition="'$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Windows)))' == 'true'" />
    <PackageReference Include="OpenCvSharp4.runtime.ubuntu.22.04-x64" Version="4.8.0.20230708" Condition="'$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Linux)))' == 'true'" />
    <!-- TensorFlow -->
    <PackageReference Include="TensorFlow.NET" Version="0.100.0" />
    <PackageReference Include="SciSharp.TensorFlow.Redist" Version="2.10.0" />
    <!-- NumPy benzeri iÃ…Å¸lemler -->
    <PackageReference Include="NumSharp" Version="0.30.0" />
    <PackageReference Include="SharpCV" Version="0.6.0" />
    <!-- YOLO iÃƒÂ§in -->
    <PackageReference Include="Yolov8.Net" Version="1.0.4" />
    <!-- GÃƒÂ¶rÃƒÂ¼ntÃƒÂ¼ iÃ…Å¸leme yardÃ„Â±mcÃ„Â±larÃ„Â± -->
    <PackageReference Include="SixLabors.ImageSharp" Version="3.1.0" />
    <PackageReference Include="SixLabors.ImageSharp.Drawing" Version="2.1.0" />
  </ItemGroup>
  <!-- ================= LOGGING ================= -->
  <ItemGroup>
    <PackageReference Include="Microsoft.Extensions.Logging" Version="8.0.0" />
    <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="8.0.0" />
    <PackageReference Include="Serilog" Version="3.1.1" />
    <PackageReference Include="Serilog.Extensions.Logging" Version="8.0.0" />
    <PackageReference Include="Serilog.Sinks.Console" Version="5.0.1" />
    <PackageReference Include="Serilog.Sinks.File" Version="5.0.0" />
  </ItemGroup>
  <!-- ================= TESTING (Opsiyonel - Development iÃƒÂ§in) ================= -->
  <ItemGroup Condition="'$(Configuration)' == 'Debug'">
    <PackageReference Include="xunit" Version="2.6.1" />
    <PackageReference Include="xunit.runner.visualstudio" Version="2.5.3">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Moq" Version="4.20.69" />
  </ItemGroup>
  <!-- ================= BUILD DAVRANIÃ…ÂI ================= -->
  <PropertyGroup Condition="'$(Configuration)'=='Debug'">
    <TreatWarningsAsErrors>false</TreatWarningsAsErrors>
    <DebugType>full</DebugType>
    <DebugSymbols>true</DebugSymbols>
    <Optimize>false</Optimize>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)'=='Release'">
    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
    <DebugType>embedded</DebugType>
    <Optimize>true</Optimize>
  </PropertyGroup>
  <!-- ================= COPY NATIVE DLLs ================= -->
  <Target Name="CopyNativeLibs" AfterTargets="Build">
    <ItemGroup>
      <NativeLibs Include="$(NuGetPackageRoot)\opencvsharp4.runtime.win\4.8.0.20230708\runtimes\win-x64\native\*.*" />
      <NativeLibs Include="$(NuGetPackageRoot)\llamasharp.backend.cpu\0.10.0\runtimes\win-x64\native\*.*" Condition="'$(EnableCuda)'!='true'" />
      <NativeLibs Include="$(NuGetPackageRoot)\scisharp.tensorflow.redist\2.10.0\runtimes\win-x64\native\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(NativeLibs)" DestinationFolder="$(OutputPath)" SkipUnchangedFiles="true" />
  </Target>
</Project>